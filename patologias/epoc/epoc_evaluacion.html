<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EPOC — GOLD/BODE/BODEx (funcional)</title>
<style>
  :root{--bg:#0b1220;--card:#111827;--txt:#e5e7eb;--mut:#a3a3a3;--ok:#10b981;--warn:#f59e0b;--bad:#ef4444}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,Segoe UI,Roboto;background:var(--bg);color:var(--txt)}
  header{padding:.9rem 1rem;background:#0f172a;border-bottom:1px solid #1f2937;text-align:center}
  main{max-width:860px;margin:0 auto;padding:1rem}
  section{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:1rem;margin:.8rem 0}
  h2{margin:.2rem 0 1rem 0;font-size:1.05rem}
  .row{display:grid;gap:.7rem}
  @media(min-width:760px){.row{grid-template-columns:repeat(12,1fr)}}
  .f{display:flex;flex-direction:column;gap:.35rem;grid-column:span 12}
  .sm{grid-column:span 6}.md{grid-column:span 4}
  label{font-size:.85rem;color:#cbd5e1}
  input,select{background:#0b1220;border:1px solid #233046;color:var(--txt);padding:.55rem .65rem;border-radius:10px}
  .kpi{display:grid;grid-template-columns:repeat(2,1fr);gap:.6rem}
  .k{border:1px solid #233046;border-radius:10px;padding:.55rem}
  .k .l{font-size:.75rem;color:#9ca3af}.k .v{font-weight:700}
  .bar{position:sticky;bottom:10px;display:flex;gap:.5rem;justify-content:center}
  button{border-radius:10px;border:1px solid #334155;background:#101827;color:#fff;padding:.55rem .9rem;cursor:pointer}
  button.primary{background:linear-gradient(90deg,#0ea5b7,#7c3aed);border:none}
  .note{font-size:.8rem;color:var(--mut)}
</style>
</head>
<body>
<header><h1>EPOC — GOLD / BODE / BODEx</h1></header>
<main>
  <section>
    <h2>1) Datos básicos</h2>
    <div class="row">
      <div class="f md"><label>Peso (kg)</label><input id="peso" type="number" inputmode="decimal"></div>
      <div class="f md"><label>Altura (cm)</label><input id="altura" type="number" inputmode="decimal"></div>
      <div class="f md"><label>IMC</label><input id="imc" readonly></div>
      <div class="f md"><label>mMRC (0–4)</label>
        <select id="mmrc"><option value="">—</option><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option></select>
      </div>
      <div class="f md"><label>CAT (0–40)</label><input id="cat" type="number" min="0" max="40"></div>
      <div class="f md"><label>FEV₁ % predicho</label><input id="fev1pct" type="number" min="0" max="200" step="0.1"></div>
      <div class="f md"><label>6MWD (m)</label><input id="sixmwd" type="number" step="1"></div>
      <div class="f md"><label>Exacerbaciones 12m</label><input id="exacs" type="number" min="0" step="1" value="0"></div>
      <div class="f md"><label>Con hospitalización</label><input id="exacsHosp" type="number" min="0" step="1" value="0"></div>
    </div>
    <div class="note">Síntomas altos si CAT ≥ 10 o mMRC ≥ 2. Riesgo alto si ≥2 exacerbaciones o ≥1 con hospitalización.</div>
  </section>

  <section>
    <h2>2) Clasificación automática</h2>
    <div class="kpi">
      <div class="k"><div class="l">Grupo GOLD</div><div id="goldGrupo" class="v">—</div></div>
      <div class="k"><div class="l">Grado GOLD (FEV₁)</div><div id="goldGrado" class="v">—</div></div>
      <div class="k"><div class="l">BODE (0–10)</div><div id="bode" class="v">—</div></div>
      <div class="k"><div class="l">BODEx (0–9)</div><div id="bodex" class="v">—</div></div>
    </div>
  </section>

  <section>
    <h2>3) Oxígeno (bandera)</h2>
    <div class="row">
      <div class="f md"><label>SaO₂ reposo (%)</label><input id="sao2" type="number" step="0.1"></div>
      <div class="f md"><label>PaO₂ (mmHg)</label><input id="pao2" type="number" step="0.1"></div>
      <div class="f md"><label>Hematocrito (%)</label><input id="hto" type="number" step="0.1"></div>
      <div class="f md"><label>Cor pulmonale</label>
        <select id="corpulmonale"><option>No</option><option>En estudio</option><option>Confirmado</option></select>
      </div>
      <div class="f md"><label>Resultado</label><input id="flagO2" readonly></div>
    </div>
    <div class="note">LTOT indicado si PaO₂ ≤55 o SaO₂ ≤88; o PaO₂ 56–59 / SaO₂ 89 con Hto &gt;55% o cor pulmonale.</div>
  </section>

  <div class="bar">
    <button id="btnCalc" class="primary">Calcular</button>
    <button id="btnClear">Limpiar</button>
  </div>
</main>
<script>
  const $ = id => document.getElementById(id);
  const num = id => { const v = parseFloat($(id).value); return isNaN(v)? null : v };
  const val = id => ($(id).value||'').trim();

  function calcIMC(){
    const p=num('peso'), a=num('altura');
    if(p && a){ const m=a/100; $('imc').value=(p/(m*m)).toFixed(1); } else { $('imc').value=''; }
  }

  function sintomasAltos(){ const m=parseInt(val('mmrc')); const c=num('cat'); return (m>=2) || (c!==null && c>=10); }
  function riesgoAlto(){ const e=parseInt(val('exacs'))||0; const h=parseInt(val('exacsHosp'))||0; return (e>=2)||(h>=1); }

  function goldGrupo(){ if(riesgoAlto()) return 'E'; return sintomasAltos()? 'B':'A'; }
  function goldGrado(){ const f=num('fev1pct'); if(f==null) return '—'; if(f>=80) return 'GOLD 1'; if(f>=50) return 'GOLD 2'; if(f>=30) return 'GOLD 3'; return 'GOLD 4'; }

  function scoreBODE(){
    const imc=num('imc'), fev=num('fev1pct'), m=parseInt(val('mmrc')), d=num('sixmwd');
    if(imc==null||fev==null||isNaN(m)||d==null) return null;
    const B=(imc<21)?1:0;
    const O=(fev>=65)?0:(fev>=50)?1:(fev>=36)?2:3;
    const D=(m<=1)?0:(m===2)?1:(m===3)?2:3;
    const E=(d>=350)?0:(d>=250)?1:(d>=150)?2:3;
    return B+O+D+E;
  }
  function scoreBODEx(){
    const imc=num('imc'), fev=num('fev1pct'), m=parseInt(val('mmrc')), ex=parseInt(val('exacs'))||0;
    if(imc==null||fev==null||isNaN(m)) return null;
    const B=(imc<21)?1:0;
    const O=(fev>=65)?0:(fev>=50)?1:(fev>=36)?2:3;
    const D=(m<=1)?0:(m===2)?1:(m===3)?2:3;
    const X=(ex===0)?0:(ex<=2?1:2);
    return B+O+D+X;
  }

  function flagOxigeno(){
    const pao2=num('pao2'), sao2=num('sao2'), hto=num('hto'); const cor=val('corpulmonale');
    const c1=(pao2!==null && pao2<=55)||(sao2!==null && sao2<=88);
    const c2=((pao2!==null && pao2>=56 && pao2<=59)||(sao2!==null && sao2==89)) && ((hto!==null && hto>55)||cor==='Confirmado');
    $('flagO2').value=(c1||c2)?'Indicado':'No indicado';
  }

  function render(){
    calcIMC();
    $('goldGrupo').textContent=goldGrupo();
    $('goldGrado').textContent=goldGrado();
    const b=scoreBODE(); $('bode').textContent=(b==null?'—':b);
    const bx=scoreBODEx(); $('bodex').textContent=(bx==null?'—':bx);
    flagOxigeno();
  }

  // Listeners (input y change)
  ['peso','altura','mmrc','cat','fev1pct','sixmwd','exacs','exacsHosp','sao2','pao2','hto','corpulmonale']
    .forEach(id=>{ const el=$(id); if(!el) return; ['input','change'].forEach(evt=>el.addEventListener(evt,render)); });

  $('btnCalc').addEventListener('click',render);
  $('btnClear').addEventListener('click',()=>{ document.querySelectorAll('input,select').forEach(el=>{ if(el.tagName==='SELECT') el.selectedIndex=0; else el.value=''; }); render(); });

  // Primera pasada
  render();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EPOC — GOLD/BODE/BODEx (funcional)</title>
<style>
  :root{--bg:#0b1220;--card:#111827;--txt:#e5e7eb;--mut:#a3a3a3;--ok:#10b981;--warn:#f59e0b;--bad:#ef4444}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,Segoe UI,Roboto;background:var(--bg);color:var(--txt)}
  header{padding:.9rem 1rem;background:#0f172a;border-bottom:1px solid #1f2937;text-align:center}
  main{max-width:860px;margin:0 auto;padding:1rem}
  section{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:1rem;margin:.8rem 0}
  h2{margin:.2rem 0 1rem 0;font-size:1.05rem}
  .row{display:grid;gap:.7rem}
  @media(min-width:760px){.row{grid-template-columns:repeat(12,1fr)}}
  .f{display:flex;flex-direction:column;gap:.35rem;grid-column:span 12}
  .sm{grid-column:span 6}.md{grid-column:span 4}
  label{font-size:.85rem;color:#cbd5e1}
  input,select{background:#0b1220;border:1px solid #233046;color:var(--txt);padding:.55rem .65rem;border-radius:10px}
  .kpi{display:grid;grid-template-columns:repeat(2,1fr);gap:.6rem}
  .k{border:1px solid #233046;border-radius:10px;padding:.55rem}
  .k .l{font-size:.75rem;color:#9ca3af}.k .v{font-weight:700}
  .bar{position:sticky;bottom:10px;display:flex;gap:.5rem;justify-content:center}
  button{border-radius:10px;border:1px solid #334155;background:#101827;color:#fff;padding:.55rem .9rem;cursor:pointer}
  button.primary{background:linear-gradient(90deg,#0ea5b7,#7c3aed);border:none}
  .note{font-size:.8rem;color:var(--mut)}
</style>
</head>
<body>
<header><h1>EPOC — GOLD / BODE / BODEx</h1></header>
<main>
  <section>
    <h2>1) Datos básicos</h2>
    <div class="row">
      <div class="f md"><label>Peso (kg)</label><input id="peso" type="number" inputmode="decimal"></div>
      <div class="f md"><label>Altura (cm)</label><input id="altura" type="number" inputmode="decimal"></div>
      <div class="f md"><label>IMC</label><input id="imc" readonly></div>
      <div class="f md"><label>mMRC (0–4)</label>
        <select id="mmrc"><option value="">—</option><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option></select>
      </div>
      <div class="f md"><label>CAT (0–40)</label><input id="cat" type="number" min="0" max="40"></div>
      <div class="f md"><label>FEV₁ % predicho</label><input id="fev1pct" type="number" min="0" max="200" step="0.1"></div>
      <div class="f md"><label>6MWD (m)</label><input id="sixmwd" type="number" step="1"></div>
      <div class="f md"><label>Exacerbaciones 12m</label><input id="exacs" type="number" min="0" step="1" value="0"></div>
      <div class="f md"><label>Con hospitalización</label><input id="exacsHosp" type="number" min="0" step="1" value="0"></div>
    </div>
    <div class="note">Síntomas altos si CAT ≥ 10 o mMRC ≥ 2. Riesgo alto si ≥2 exacerbaciones o ≥1 con hospitalización.</div>
  </section>

  <section>
    <h2>2) Clasificación automática</h2>
    <div class="kpi">
      <div class="k"><div class="l">Grupo GOLD</div><div id="goldGrupo" class="v">—</div></div>
      <div class="k"><div class="l">Grado GOLD (FEV₁)</div><div id="goldGrado" class="v">—</div></div>
      <div class="k"><div class="l">BODE (0–10)</div><div id="bode" class="v">—</div></div>
      <div class="k"><div class="l">BODEx (0–9)</div><div id="bodex" class="v">—</div></div>
    </div>
  </section>

  <section>
    <h2>3) Oxígeno (bandera)</h2>
    <div class="row">
      <div class="f md"><label>SaO₂ reposo (%)</label><input id="sao2" type="number" step="0.1"></div>
      <div class="f md"><label>PaO₂ (mmHg)</label><input id="pao2" type="number" step="0.1"></div>
      <div class="f md"><label>Hematocrito (%)</label><input id="hto" type="number" step="0.1"></div>
      <div class="f md"><label>Cor pulmonale</label>
        <select id="corpulmonale"><option>No</option><option>En estudio</option><option>Confirmado</option></select>
      </div>
      <div class="f md"><label>Resultado</label><input id="flagO2" readonly></div>
    </div>
    <div class="note">LTOT indicado si PaO₂ ≤55 o SaO₂ ≤88; o PaO₂ 56–59 / SaO₂ 89 con Hto &gt;55% o cor pulmonale.</div>
  </section>

  <div class="bar">
    <button id="btnCalc" class="primary">Calcular</button>
    <button id="btnClear">Limpiar</button>
  </div>
</main>
<script>
  const $ = id => document.getElementById(id);
  const num = id => { const v = parseFloat($(id).value); return isNaN(v)? null : v };
  const val = id => ($(id).value||'').trim();

  function calcIMC(){
    const p=num('peso'), a=num('altura');
    if(p && a){ const m=a/100; $('imc').value=(p/(m*m)).toFixed(1); } else { $('imc').value=''; }
  }

  function sintomasAltos(){ const m=parseInt(val('mmrc')); const c=num('cat'); return (m>=2) || (c!==null && c>=10); }
  function riesgoAlto(){ const e=parseInt(val('exacs'))||0; const h=parseInt(val('exacsHosp'))||0; return (e>=2)||(h>=1); }

  function goldGrupo(){ if(riesgoAlto()) return 'E'; return sintomasAltos()? 'B':'A'; }
  function goldGrado(){ const f=num('fev1pct'); if(f==null) return '—'; if(f>=80) return 'GOLD 1'; if(f>=50) return 'GOLD 2'; if(f>=30) return 'GOLD 3'; return 'GOLD 4'; }

  function scoreBODE(){
    const imc=num('imc'), fev=num('fev1pct'), m=parseInt(val('mmrc')), d=num('sixmwd');
    if(imc==null||fev==null||isNaN(m)||d==null) return null;
    const B=(imc<21)?1:0;
    const O=(fev>=65)?0:(fev>=50)?1:(fev>=36)?2:3;
    const D=(m<=1)?0:(m===2)?1:(m===3)?2:3;
    const E=(d>=350)?0:(d>=250)?1:(d>=150)?2:3;
    return B+O+D+E;
  }
  function scoreBODEx(){
    const imc=num('imc'), fev=num('fev1pct'), m=parseInt(val('mmrc')), ex=parseInt(val('exacs'))||0;
    if(imc==null||fev==null||isNaN(m)) return null;
    const B=(imc<21)?1:0;
    const O=(fev>=65)?0:(fev>=50)?1:(fev>=36)?2:3;
    const D=(m<=1)?0:(m===2)?1:(m===3)?2:3;
    const X=(ex===0)?0:(ex<=2?1:2);
    return B+O+D+X;
  }

  function flagOxigeno(){
    const pao2=num('pao2'), sao2=num('sao2'), hto=num('hto'); const cor=val('corpulmonale');
    const c1=(pao2!==null && pao2<=55)||(sao2!==null && sao2<=88);
    const c2=((pao2!==null && pao2>=56 && pao2<=59)||(sao2!==null && sao2==89)) && ((hto!==null && hto>55)||cor==='Confirmado');
    $('flagO2').value=(c1||c2)?'Indicado':'No indicado';
  }

  function render(){
    calcIMC();
    $('goldGrupo').textContent=goldGrupo();
    $('goldGrado').textContent=goldGrado();
    const b=scoreBODE(); $('bode').textContent=(b==null?'—':b);
    const bx=scoreBODEx(); $('bodex').textContent=(bx==null?'—':bx);
    flagOxigeno();
  }

  // Listeners (input y change)
  ['peso','altura','mmrc','cat','fev1pct','sixmwd','exacs','exacsHosp','sao2','pao2','hto','corpulmonale']
    .forEach(id=>{ const el=$(id); if(!el) return; ['input','change'].forEach(evt=>el.addEventListener(evt,render)); });

  $('btnCalc').addEventListener('click',render);
  $('btnClear').addEventListener('click',()=>{ document.querySelectorAll('input,select').forEach(el=>{ if(el.tagName==='SELECT') el.selectedIndex=0; else el.value=''; }); render(); });

  // Primera pasada
  render();
</script>
</body>
</html>
